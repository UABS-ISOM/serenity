{"version":3,"sources":["../../src/pages/buddies/buddies.module.ts","../../src/pages/buddies/buddies.ts"],"names":[],"mappings":"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","file":"8.js","sourcesContent":["import { NgModule } from \"@angular/core\";\nimport { IonicPageModule } from \"ionic-angular\";\nimport { BuddiesPage } from \"./buddies\";\nimport { IonicImageLoader } from \"ionic-image-loader\";\n\n@NgModule({\n  declarations: [BuddiesPage],\n  imports: [IonicPageModule.forChild(BuddiesPage), IonicImageLoader],\n})\nexport class BuddiesPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/buddies/buddies.module.ts","import { Component, NgZone } from \"@angular/core\";\nimport {\n  IonicPage,\n  NavController,\n  NavParams,\n  Events,\n  AlertController,\n} from \"ionic-angular\";\nimport { UserProvider } from \"../../providers/user/user\";\nimport { RequestsProvider } from \"../../providers/requests/requests\";\nimport { connreq } from \"../../models/interfaces/request\";\nimport firebase from \"firebase\";\n/**\n * Generated class for the BuddiesPage page.\n *\n * See http://ionicframework.com/docs/components/#navigation for more info\n * on Ionic pages and navigation.\n */\n@IonicPage()\n@Component({\n  selector: \"page-buddies\",\n  templateUrl: \"buddies.html\",\n})\nexport class BuddiesPage {\n  newrequest = {} as connreq;\n  temparr = [];\n  myfriends;\n  userID;\n  unfilteredusers = [];\n  filteredusers = [];\n  currentuserid;\n  recipients = [];\n  constructor(\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    public userservice: UserProvider,\n    public events: Events,\n    public alertCtrl: AlertController,\n    public requestservice: RequestsProvider,\n    public zone: NgZone\n  ) {\n    this.userservice.getallusers().then((res: any) => {\n      this.unfilteredusers = res;\n      this.temparr = res;\n    });\n  }\n\n  ionViewWillEnter() {\n    this.requestservice.getmyfriends();\n    this.myfriends = [];\n    this.events.subscribe(\"friends\", () => {\n      this.myfriends = [];\n      this.myfriends = this.requestservice.myfriends;\n    });\n    this.loaduserdetails();\n  }\n\n  ionViewDidLeave() {\n    this.events.unsubscribe(\"friends\");\n  }\n\n  // ionViewDidLoad() {}\n  ionViewDidEnter() {\n    this.filterusers(this.unfilteredusers, this.myfriends);\n    // this.requestservice.log();\n  }\n\n  filterusers(users, friends) {\n    // var friendrequests = this.requestservice.log();\n    for (var i = users.length - 1; i >= 0; i--) {\n      for (var j = 0; j < friends.length; j++) {\n        if (users[i].uid === this.userID) {\n          users.splice(i, 1);\n        } else if (users[i].uid === friends[j].uid) {\n          users.splice(i, 1);\n        }\n      }\n    }\n    this.filteredusers = users;\n  }\n\n  loaduserdetails() {\n    this.userservice.getuserdetails().then((res: any) => {\n      this.zone.run(() => {\n        this.userID = res.uid;\n        console.log(this.userID);\n      });\n    });\n  }\n\n  searchuser(searchbar) {\n    this.filteredusers = this.temparr;\n    var q = searchbar.target.value;\n    if (q.trim() == \"\") {\n      return;\n    }\n\n    this.filteredusers = this.filteredusers.filter((v) => {\n      if (v.id.indexOf(q) > -1) {\n        return true;\n      }\n      return false;\n    });\n  }\n\n  sendreq(recipient) {\n    this.newrequest.sender = firebase.auth().currentUser.uid;\n    this.newrequest.recipient = recipient.uid;\n    if (this.newrequest.sender === this.newrequest.recipient)\n      alert(\"You can't add yourself!\");\n    else {\n      let successalert = this.alertCtrl.create({\n        title: \"Request Sent!\",\n        subTitle: \"Your request was sent to \" + recipient.displayName + \".\",\n        buttons: [\"Okay\"],\n      });\n\n      this.requestservice\n        .sendrequest(this.newrequest)\n        .then((res: any) => {\n          if (res.success) {\n            successalert.present();\n            let sentuser = this.filteredusers.indexOf(recipient);\n            this.filteredusers.splice(sentuser, 1);\n          }\n        })\n        .catch((err) => {\n          alert(err);\n        });\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/buddies/buddies.ts"],"sourceRoot":""}